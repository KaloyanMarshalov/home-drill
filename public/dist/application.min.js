"use strict"; var ApplicationConfiguration = function () { var e = "mean", t = ["ngResource", "ngAnimate", "ui.router", "ui.bootstrap", "ui.utils"], i = function (t) { angular.module(t, []), angular.module(e).requires.push(t) }; return { applicationModuleName: e, applicationModuleVendorDependencies: t, registerModule: i } }(); angular.module(ApplicationConfiguration.applicationModuleName, ApplicationConfiguration.applicationModuleVendorDependencies), angular.module(ApplicationConfiguration.applicationModuleName).config(["$locationProvider", function (e) { e.hashPrefix("!") }]), angular.element(document).ready(function () { "#_=_" === window.location.hash && (window.location.hash = "#!"), angular.bootstrap(document, [ApplicationConfiguration.applicationModuleName]) }), ApplicationConfiguration.registerModule("core"), ApplicationConfiguration.registerModule("exercises"), ApplicationConfiguration.registerModule("users"), ApplicationConfiguration.registerModule("workouts"), angular.module("core").config(["$stateProvider", "$urlRouterProvider", function (e, t) { t.otherwise("/"), e.state("home", { url: "/", templateUrl: "modules/core/views/home.client.view.html" }).state("about", { url: "/about", templateUrl: "modules/core/views/about.client.view.html" }) }]), angular.module("core").controller("HeaderController", ["$scope", "Authentication", "Menus", function (e, t, i) { e.authentication = t, e.isCollapsed = !1, e.menu = i.getMenu("topbar"), e.toggleCollapsibleMenu = function () { e.isCollapsed = !e.isCollapsed }, e.$on("$stateChangeSuccess", function () { e.isCollapsed = !1 }) }]), angular.module("core").controller("HomeController", ["$scope", "Authentication", function (e, t) { e.authentication = t }]), angular.module("core").service("Menus", [function () { this.defaultRoles = ["user"], this.menus = {}; var e = function (e) { if (!e) return this.isPublic; for (var t in e.roles) for (var i in this.roles) if (this.roles[i] === e.roles[t]) return !0; return !1 }; this.validateMenuExistance = function (e) { if (e && e.length) { if (this.menus[e]) return !0; throw new Error("Menu does not exists") } throw new Error("MenuId was not provided") }, this.getMenu = function (e) { return this.validateMenuExistance(e), this.menus[e] }, this.addMenu = function (t, i, s) { return this.menus[t] = { isPublic: i || !1, roles: s || this.defaultRoles, items: [], shouldRender: e }, this.menus[t] }, this.removeMenu = function (e) { this.validateMenuExistance(e), delete this.menus[e] }, this.addMenuItem = function (t, i, s, r, o, n, u) { return this.validateMenuExistance(t), this.menus[t].items.push({ title: i, link: s, menuItemType: r || "item", menuItemClass: r, uiRoute: o || "/" + s, isPublic: n || this.menus[t].isPublic, roles: u || this.defaultRoles, items: [], shouldRender: e }), this.menus[t] }, this.addSubMenuItem = function (t, i, s, r, o, n, u) { this.validateMenuExistance(t); for (var a in this.menus[t].items) this.menus[t].items[a].link === i && this.menus[t].items[a].items.push({ title: s, link: r, uiRoute: o || "/" + r, isPublic: n || this.menus[t].isPublic, roles: u || this.defaultRoles, shouldRender: e }); return this.menus[t] }, this.removeMenuItem = function (e, t) { this.validateMenuExistance(e); for (var i in this.menus[e].items) this.menus[e].items[i].link === t && this.menus[e].items.splice(i, 1); return this.menus[e] }, this.removeSubMenuItem = function (e, t) { this.validateMenuExistance(e); for (var i in this.menus[e].items) for (var s in this.menus[e].items[i].items) this.menus[e].items[i].items[s].link === t && this.menus[e].items[i].items.splice(s, 1); return this.menus[e] }, this.addMenu("topbar") }]), angular.module("exercises").config(["$stateProvider", function (e) { e.state("listExercises", { url: "/exercises", templateUrl: "modules/exercises/views/list-exercises.client.view.html" }).state("createExercise", { url: "/exercises/create", templateUrl: "modules/exercises/views/create-exercise.client.view.html" }).state("viewExercise", { url: "/exercises/:exerciseId", templateUrl: "modules/exercises/views/view-exercise.client.view.html" }).state("editExercise", { url: "/exercises/:exerciseId/edit", templateUrl: "modules/exercises/views/edit-exercise.client.view.html" }) }]), angular.module("exercises").controller("ExercisesController", ["$scope", "$stateParams", "$location", "Authentication", "Exercises", function (e, t, i, s, r) { e.authentication = s, e.create = function () { var t = new r({ name: this.name, type: this.type, difficulty: this.difficulty, muscleGroup: this.muscleGroup, equipment: this.equipment, picture: this.picture, youTube: this.youTube }); this.equipment || (t.equipment = "None"), t.$save(function (e) { i.path("exercise/" + e._id) }, function (t) { e.error = t.data.message }) }, e.remove = function (t) { if (t) { t.$remove(); for (var s in e.exercises) e.exercises[s] === t && e.exercises.splice(s, 1) } else e.exercise.$remove(function () { i.path("exercises") }) }, e.update = function () { var t = e.exercise; this.equipment || (t.equipment = "None"), t.$update(function () { i.path("exercises/" + t._id) }, function (t) { e.error = t.data.message }) }, e.find = function () { e.exercises = r.query() }, e.findOne = function () { e.exercise = r.get({ exerciseId: t.exerciseId }) }, e.range = function () { for (var t = [], i = 0; i < e.exercises.length; i++) i % 4 === 0 && t.push(i); return t }, e.addToWorkout = function () { var t = sessionStorage.length; sessionStorage.setItem("exercise" + t, e.exercise._id), e.successfulAdding = !e.successfulAdding } }]).filter("displayMuscles", function () { return function (e) { var t = ""; return t = e.join(", ") } }), angular.module("exercises").factory("Exercises", ["$resource", function (e) { return e("exercises/:exerciseId", { exerciseId: "@_id" }, { update: { method: "PUT" } }) }]), angular.module("users").config(["$httpProvider", function (e) { e.interceptors.push(["$q", "$location", "Authentication", function (e, t, i) { return { responseError: function (s) { switch (s.status) { case 401: i.user = null, t.path("signin"); break; case 403: } return e.reject(s) } } }]) }]), angular.module("users").config(["$stateProvider", function (e) { e.state("profile", { url: "/settings/profile", templateUrl: "modules/users/views/settings/edit-profile.client.view.html" }).state("password", { url: "/settings/password", templateUrl: "modules/users/views/settings/change-password.client.view.html" }).state("accounts", { url: "/settings/accounts", templateUrl: "modules/users/views/settings/social-accounts.client.view.html" }).state("signup", { url: "/signup", templateUrl: "modules/users/views/signup.client.view.html" }).state("signin", { url: "/signin", templateUrl: "modules/users/views/signin.client.view.html" }) }]), angular.module("users").controller("AuthenticationController", ["$scope", "$http", "$location", "Authentication", function (e, t, i, s) { e.authentication = s, e.authentication.user && i.path("/"), e.signup = function () { t.post("/auth/signup", e.credentials).success(function (t) { e.authentication.user = t, i.path("/") }).error(function (t) { e.error = t.message }) }, e.signin = function () { t.post("/auth/signin", e.credentials).success(function (t) { e.authentication.user = t, i.path("/") }).error(function (t) { e.error = t.message }) } }]), angular.module("users").controller("SettingsController", ["$scope", "$http", "$location", "Users", "Authentication", function (e, t, i, s, r) { e.user = r.user, e.user || i.path("/"), e.hasConnectedAdditionalSocialAccounts = function () { for (var t in e.user.additionalProvidersData) return !0; return !1 }, e.isConnectedSocialAccount = function (t) { return e.user.provider === t || e.user.additionalProvidersData && e.user.additionalProvidersData[t] }, e.removeUserSocialAccount = function (i) { e.success = e.error = null, t.delete("/users/accounts", { params: { provider: i } }).success(function (t) { e.success = !0, e.user = r.user = t }).error(function (t) { e.error = t.message }) }, e.updateUserProfile = function () { e.success = e.error = null; var t = new s(e.user); t.$update(function (t) { e.success = !0, r.user = t }, function (t) { e.error = t.data.message }) }, e.changeUserPassword = function () { e.success = e.error = null, t.post("/users/password", e.passwordDetails).success(function () { e.success = !0, e.passwordDetails = null }).error(function (t) { e.error = t.message }) } }]), angular.module("users").factory("Authentication", [function () { var e = this; return e._data = { user: window.user }, e._data }]), angular.module("users").factory("Users", ["$resource", function (e) { return e("users", {}, { update: { method: "PUT" } }) }]), angular.module("workouts").config(["$stateProvider", function (e) { e.state("listWorkouts", { url: "/workouts", templateUrl: "modules/workouts/views/list-workouts.client.view.html" }).state("createWorkout", { url: "/workouts/create", templateUrl: "modules/workouts/views/create-workout.client.view.html" }).state("viewWorkout", { url: "/workouts/:workoutId", templateUrl: "modules/workouts/views/view-workout.client.view.html" }).state("editWorkout", { url: "/workouts/:workoutId/edit", templateUrl: "modules/workouts/views/edit-workout.client.view.html" }).state("executeWorkout", { url: "/workouts/:workoutId/execute", templateUrl: "modules/workouts/views/execute-workout.client.view.html" }) }]), angular.module("workouts").controller("WorkoutsController", ["$scope", "$stateParams", "$location", "$timeout", "Authentication", "Workouts", "Exercises", function (e, t, i, s, r, o, n) { e.authentication = r; var u = [], a = 0, c = []; for (var l in sessionStorage) { var m = n.get({ exerciseId: sessionStorage.getItem(l) }); u.push(m) } e.currStorageEx = u[a], e.showTimerSelect = function () { e.durationSelected = !0 }, e.exerciseTime = 0, e.incrementTime = function () { 120 !== e.exerciseTime && (e.exerciseTime += 10) }, e.decrementTime = function () { 0 !== e.exerciseTime && (e.exerciseTime -= 10) }, e.create = function () { if (a === sessionStorage.length) { var t = new o({ name: this.workoutName, exercises: c }); console.log(t), t.$save(function (e) { i.path("workout/" + e._id) }, function (t) { e.error = t.data.message }), sessionStorage.clear(), a = 0 } else c.push({ name: e.currStorageEx.name, picture: e.currStorageEx.picture, type: this.type, time: this.exerciseTime }), a += 1, e.currStorageEx = u[a], e.exerciseTime = 0, e.durationSelected = !1; console.log(c) }, e.remove = function (t) { if (t) { t.$remove(); for (var s in e.workouts) e.workouts[s] === t && e.workouts.splice(s, 1) } else e.workout.$remove(function () { i.path("workouts") }) }, e.update = function () { var t = e.workout; t.$update(function () { i.path("workouts/" + t._id) }, function (t) { e.error = t.data.message }) }, e.find = function () { e.workouts = o.query(), console.log(e.workouts) }, e.findOne = function () { e.workout = o.get({ workoutId: t.workoutId }) }, e.timerFunction = function (t) { if (9 >= t) e.time = "0:0" + t; else if (59 >= t) e.time = "0:" + t; else { var i = t / 60 | 0, s = t % 60; e.time = 9 >= s ? i + ":0" + s : i + ":" + s } }; var d, h = 11, p = 0, f = 0, g = 0; e.execute = function () { e.currExercise = e.workout.exercises[f], 0 === h ? (p = e.currExercise.time, e.workoutPart = "Exercise", "Repetitions" === e.currExercise.type ? (e.continueWorkoutBtn = !0, e.continueWorkout = function () { f += 1, h = 11 }) : (p -= g, g += 1, 0 === p && (f += 1, h = 11, g = 0), e.timerFunction(p))) : (e.workoutPart = "Preparation time", h--, e.timerFunction(h)), f < e.workout.exercises.length ? d = s(e.execute, 1e3) : e.endWorkout = !0 } }]), angular.module("workouts").factory("Workouts", ["$resource", function (e) { return e("workouts/:workoutId", { workoutId: "@_id" }, { update: { method: "PUT" } }) }]);